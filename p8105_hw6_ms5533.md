Homework 6
================
Marisa Sobel
11/16/2018

# Problem 1

### DATA IMPORT AND TIDY

``` r
wp_homicide_data = 
  read_csv("./data/data-homicides-master/homicide-data.csv", na = c("", "Unknown", "NA")) %>% 
  mutate(city_state = str_c(city, state, sep = ", ")) %>% 
  filter(!city_state %in% c("Dallas, TX", "Pheonix, AZ", "Tulsa, AL")) %>% 
  filter(victim_race != "NA" | victim_age != "NA") %>% 
  select(-uid, -reported_date, -victim_first, -victim_last, -lat, -lon, -city, -state) %>% 
  mutate(
    victim_race = as_factor(case_when(
      victim_race == "White" ~ "white", 
      victim_race != "white" ~ "non-white")), 
    victim_race = fct_relevel(victim_race, "white"),
    victim_sex = as_factor(tolower(victim_sex)), 
    victim_sex = fct_relevel(victim_sex, "male"), 
    victim_age = as.numeric(victim_age),
    outcome = as_factor(case_when(
      disposition == "Closed by arrest" ~ "resolved", 
      disposition == "Closed without arrest" ~ "unresolved", 
      disposition == "Open/No arrest" ~ "unresolved")))

wp_homicide_data
## # A tibble: 49,570 x 6
##    victim_race victim_age victim_sex disposition     city_state   outcome 
##    <fct>            <dbl> <fct>      <chr>           <chr>        <fct>   
##  1 non-white           78 male       Closed without… Albuquerque… unresol…
##  2 non-white           17 male       Closed by arre… Albuquerque… resolved
##  3 white               15 female     Closed without… Albuquerque… unresol…
##  4 non-white           32 male       Closed by arre… Albuquerque… resolved
##  5 white               72 female     Closed without… Albuquerque… unresol…
##  6 white               91 female     Open/No arrest  Albuquerque… unresol…
##  7 non-white           52 male       Closed by arre… Albuquerque… resolved
##  8 non-white           52 female     Closed by arre… Albuquerque… resolved
##  9 white               56 male       Open/No arrest  Albuquerque… unresol…
## 10 non-white           43 male       Open/No arrest  Albuquerque… unresol…
## # ... with 49,560 more rows
```

### BALTIMORE, MD

#### GLM (resolved/unresolved)

``` r
# baltimore glm model 
glm_baltimore = 
  wp_homicide_data %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(outcome ~ victim_age + victim_sex + victim_race, data = ., family = binomial)

# get OR and CIs
tidy(glm_baltimore, conf.int = TRUE) %>% 
  mutate(OR = inv.logit(estimate), 
         CI_low = inv.logit(conf.low), 
         CI_high = inv.logit(conf.high)) %>% 
  select(term, OR, CI_low, CI_high) %>% 
  filter(term == "victim_racenon-white") %>% 
  knitr::kable(digits = 3)
```

| term                  |    OR | CI\_low | CI\_high |
| :-------------------- | ----: | ------: | -------: |
| victim\_racenon-white | 0.306 |   0.238 |    0.383 |

### ALL CITIES

#### GLM (resolved/unresolved)

### ALL CITIES

#### Plot - ORs + CIs

# Problem 2

### DATA IMPORT AND TIDY

``` r
birthweight_data = 
  read_csv("./data/birthweight.csv") %>% 
  mutate(
    babysex = factor(babysex, labels = c("male", "female")), 
    frace = factor(frace, labels = c("white", "black", "asian", "puerto_rican", "other", "unknown")))


  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY", 
                      USC00519397 = "Waikiki_HA",
                      USS0023B17S = "Waterhole_WA"),
```
